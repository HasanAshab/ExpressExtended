require("dotenv").config();
const args = process.argv;
const commands = require("./register/commands");
global.__basedir = __dirname;

try {
  const commandArgs = args.splice(3);
  if (args[2].includes(":")) {
    const [commandKey, subComand] = args[2].split(":");
    const CommandClass = require(commands.nested[commandKey]);
    var command =
      new CommandClass()[subComand] || new CommandClass(subComand).handle;
  } else {
    const CommandClass = require(commands.invoked[args[2]]);
    var command = new CommandClass().handle;
  }
  if (command.length !== commandArgs.length) {
    return console.log("\x1b[31m", "\n Number of Argument is Invalid!\n");
  }
  command(...commandArgs);
} catch (err) {
  if (err instanceof TypeError) {
    console.log("\x1b[31m", "\n Command not found!\n");
  }
  console.log(err);
}
